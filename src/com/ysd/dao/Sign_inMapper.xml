<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ysd.dao.Sign_inMapper">
	<!-- 签到 -->
	<insert id="addSign_in" parameterType="sign_in">
	insert into sign_in(user_id,create_time,sign_in_end_time)values(#{user_id},#{create_time},#{sign_in_end_time})
	</insert>
	<!-- 签到成功：修改用户签到状态 -->
	<update id="UpdateUserSignstate" parameterType="sign_in">
		update users 
		<set>
				sign_in_state='1',sign_state='0'
		</set>
		<where>
				user_id=#{user_id}
		</where>
	</update>
	<!-- 查询当天是否已经签到 -->
	<select id="selectBySigntime" parameterType="sign_in" resultType="sign_in"> 
	select * from sign_in where user_id=#{user_id} and create_time like #{create_time}"%"
	</select>
	<!--签退  -->
	<update id="updateSign" parameterType="sign_in">
	update sign_in set sign_in_end_time=#{sign_in_end_time} where sign_in_id=#{sign_in_id}
	</update>
	<!-- 签退成功：修改用户签到状态 -->
	<update id="UpdateUserSignstateIn" parameterType="sign_in">
		update users 
		<set>
				sign_in_state='0',sign_state='2'
		</set>
		<where>
				user_id=#{user_id}
		</where>
	</update>
   <!--  根据用户id查询签到数据 -->
	<select id="selectSignByUserid" parameterType="sign_in" resultType="sign_in">
  			select * from sign_in where sign_in_id=#{sign_in_id} and user_id=#{user_id}
  		</select>
  	 <!--查询该用户当天签到信息 -->	
  		<select id="selectSignByUserids" parameterType="sign_in" resultType="sign_in">
  			select * from sign_in where user_id=#{user_id} and create_time>#{create_time}
  		
  		</select>
	
</mapper>